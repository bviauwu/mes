{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mili\\\\Desktop\\\\messenger\\\\client\\\\src\\\\components\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SERVER = 'http://10.40.31.124:5000';\nexport default function Chat({\n  username,\n  token,\n  onLogout\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [text, setText] = useState('');\n  const socketRef = useRef(null);\n  const listRef = useRef(null);\n  useEffect(() => {\n    fetch(`${SERVER}/messages`).then(r => r.json()).then(setMessages).catch(() => {});\n    const socket = io(SERVER, {\n      auth: {\n        token\n      }\n    });\n    socketRef.current = socket;\n    socket.on('connect', () => {\n      console.log('socket connected', socket.id);\n    });\n    socket.on('message', msg => {\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('users', u => setUsers(u));\n    socket.on('connect_error', err => {\n      console.warn('connect_error', err.message);\n    });\n    return () => socket.disconnect();\n  }, [token]);\n  useEffect(() => {\n    if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n  }, [messages]);\n  function send() {\n    const t = text.trim();\n    if (!t) return;\n    socketRef.current.emit('message', {\n      text: t\n    });\n    setText('');\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      height: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        display: 'flex',\n        flexDirection: 'column',\n        borderRight: '1px solid #ddd'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: 10,\n          borderBottom: '1px solid #eee',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"Zalogowany jako: \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: onLogout && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onLogout,\n            children: \"Wyloguj\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: listRef,\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          padding: 10\n        },\n        children: messages.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: 12,\n              color: '#555'\n            },\n            children: [m.username, \" \\xB7 \", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontSize: 11,\n                color: '#999'\n              },\n              children: new Date(m.time).toLocaleTimeString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 70\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: m.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 15\n          }, this)]\n        }, m.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: 10,\n          borderTop: '1px solid #eee',\n          display: 'flex',\n          gap: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: text,\n          onChange: e => setText(e.target.value),\n          onKeyDown: e => e.key === 'Enter' && send(),\n          style: {\n            flex: 1\n          },\n          placeholder: \"Napisz wiadomo\\u015B\\u0107...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: send,\n          children: \"Wy\\u015Blij\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: 220,\n        padding: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Online\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: users.map((u, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: u\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 32\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"BuFNMQDWE9My8y4pttEhNKRUPKM=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useRef","io","jsxDEV","_jsxDEV","SERVER","Chat","username","token","onLogout","_s","messages","setMessages","users","setUsers","text","setText","socketRef","listRef","fetch","then","r","json","catch","socket","auth","current","on","console","log","id","msg","prev","u","err","warn","message","disconnect","scrollTop","scrollHeight","send","t","trim","emit","style","display","height","children","flex","flexDirection","borderRight","padding","borderBottom","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","overflowY","map","m","marginBottom","fontSize","color","Date","time","toLocaleTimeString","borderTop","gap","value","onChange","e","target","onKeyDown","key","placeholder","width","i","_c","$RefreshReg$"],"sources":["C:/Users/mili/Desktop/messenger/client/src/components/Chat.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\n\r\nconst SERVER = 'http://10.40.31.124:5000';\r\n\r\nexport default function Chat({ username, token, onLogout }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [text, setText] = useState('');\r\n  const socketRef = useRef(null);\r\n  const listRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    fetch(`${SERVER}/messages`).then(r => r.json()).then(setMessages).catch(()=>{});\r\n    const socket = io(SERVER, { auth: { token } });\r\n    socketRef.current = socket;\r\n    socket.on('connect', () => {\r\n      console.log('socket connected', socket.id);\r\n    });\r\n    socket.on('message', (msg) => {\r\n      setMessages(prev => [...prev, msg]);\r\n    });\r\n    socket.on('users', (u) => setUsers(u));\r\n    socket.on('connect_error', (err) => {\r\n      console.warn('connect_error', err.message);\r\n    });\r\n    return () => socket.disconnect();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\r\n  }, [messages]);\r\n\r\n  function send() {\r\n    const t = text.trim();\r\n    if (!t) return;\r\n    socketRef.current.emit('message', { text: t });\r\n    setText('');\r\n  }\r\n\r\n  return (\r\n    <div style={{display:'flex',height:'100vh'}}>\r\n      <div style={{flex:1,display:'flex',flexDirection:'column',borderRight:'1px solid #ddd'}}>\r\n        <div style={{padding:10, borderBottom:'1px solid #eee', display:'flex', justifyContent:'space-between', alignItems:'center'}}>\r\n          <div>Zalogowany jako: <b>{username}</b></div>\r\n          <div>\r\n            {onLogout && <button onClick={onLogout}>Wyloguj</button>}\r\n          </div>\r\n        </div>\r\n        <div ref={listRef} style={{flex:1, overflowY:'auto', padding:10}}>\r\n          {messages.map(m => (\r\n            <div key={m.id} style={{marginBottom:8}}>\r\n              <div style={{fontSize:12,color:'#555'}}>{m.username} · <span style={{fontSize:11,color:'#999'}}>{new Date(m.time).toLocaleTimeString()}</span></div>\r\n              <div>{m.text}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div style={{padding:10, borderTop:'1px solid #eee', display:'flex', gap:8}}>\r\n          <input value={text} onChange={e=>setText(e.target.value)} onKeyDown={e=>e.key==='Enter' && send()} style={{flex:1}} placeholder=\"Napisz wiadomość...\" />\r\n          <button onClick={send}>Wyślij</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{width:220,padding:10}}>\r\n        <h4>Online</h4>\r\n        <ul>\r\n          {users.map((u, i) => <li key={i}>{u}</li>)}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}